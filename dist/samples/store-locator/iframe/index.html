<!DOCTYPE html>
<!--
 @license
 Copyright 2019 Google LLC. All Rights Reserved.
 SPDX-License-Identifier: Apache-2.0
-->
<html>
  <head>
    <title>Store Locator</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <link
      href="https://unpkg.com/material-components-web@6.0.0/dist/material-components-web.css"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/material-components-web@6.0.0/dist/material-components-web.min.js"></script>
    <script src="https://unpkg.com/@google/markerclustererplus@^4.0.1/dist/markerclustererplus.min.js"></script>
    <head>
      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/icon?family=Material+Icons"
      />
      <script type="module">!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */
let e,t,n,o,a,r,s=!1;const i=[];function c(){a.disabled=!0;d(o.getPlace().geometry.location),e.setZoom(10),e.setMapTypeId(t)}function d(t){t&&(s?alert("Update in progress, please try again."):(a.disabled=!0,s=!0,e.setCenter(t),i.forEach((e=>{delete e.travelDistance,delete e.travelDistanceText,delete e.travelDuration,delete e.travelDurationText})),i.sort(((e,n)=>google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e.location),t)-google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(n.location),t))),function(e){const t=[e];return new Promise(((e,n)=>{r.getDistanceMatrix({origins:t,destinations:i.slice(0,25).map((e=>e.location)),travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL},((t,o)=>{o===google.maps.DistanceMatrixStatus.OK&&t?e(t):n(o)}))}))}(t).then((e=>{for(let t=0;t<e.rows[0].elements.length;t++)i[t].address=e.destinationAddresses[t],i[t].travelDistance=e.rows[0].elements[t].distance.value,i[t].travelDistanceText=e.rows[0].elements[t].distance.text,i[t].travelDuration=e.rows[0].elements[t].duration.value,i[t].travelDurationText=e.rows[0].elements[t].duration.text})).finally((()=>{!function(e){const t=document.getElementById("cards");t.innerHTML="",e.slice(0,25).forEach((({name:e,location:n,address:o,travelDistanceText:a,travelDurationText:r})=>{const s=document.createElement("div");s.classList.add("mdc-card","mdc-card--outlined"),s.innerHTML=`\n<div class="mdc-card__primary-action">\n  <div id="card-header">\n    <h2 class="mdc-typography--headline6">${e}</h2>\n  </div>\n</div>\n<div id="card-body">\n  </div>\n<div class="mdc-card__actions">\n  <a class="mdc-button mdc-card__action mdc-card__action--button"\n    target="_blank" href="https://maps.google.com?q=${o||e}">\n    <div class="mdc-button__ripple"></div>\n    <span class="mdc-button__label">Directions</span>\n  </a>\n  <button class="mdc-button mdc-card__action mdc-card__action--button">\n    <div class="mdc-button__ripple"></div>\n    <span class="mdc-button__label">More Information</span>\n  </button>\n</div>`;const i=s.querySelector("#card-body");o&&(i.innerHTML=`<h2 class="mdc-typography--body1">${o}</h2>`),a&&(i.innerHTML+=`<h2 class="mdc-typography--body2">${a}, ${r}</h2>`),s.querySelector(".mdc-card__primary-action").addEventListener("click",(()=>{l(new google.maps.LatLng(n))})),t.appendChild(s)})),t.scrollTo(0,0)}(i),a.disabled=!1,s=!1}))))}function l(o){e.setCenter(o),e.setZoom(19),e.setMapTypeId(n),e.setTilt(45),google.maps.event.addListenerOnce(e,"zoom_changed",(()=>{e.getZoom()<19&&(e.setTilt(0),e.setMapTypeId(t))}))}window.initMap=function(){r=new google.maps.DistanceMatrixService,t=google.maps.MapTypeId.ROADMAP,n=google.maps.MapTypeId.HYBRID,e=new google.maps.Map(document.getElementById("map"),{center:{lat:39.79,lng:-104.98},mapTypeId:t,zoom:10}),new mdc.textField.MDCTextField(document.querySelector(".mdc-text-field")),a=document.getElementById("search-input"),o=new google.maps.places.Autocomplete(a,{fields:["geometry"]}),o.addListener("place_changed",c),o.bindTo("bounds",e),fetch("https://carto.nationalmap.gov/arcgis/rest/services/structures/MapServer/23/query?where=STATE%3D%27CO%27&returnGeometry=true&outSR=4326&f=pjson").then((e=>e.json())).then((n=>{const o=n.features,a=[];o.forEach((({attributes:{NAME:e},geometry:{x:t,y:n}})=>{i.push({name:e,location:{lat:n,lng:t},address:""});const o=new google.maps.Marker({position:{lat:n,lng:t}});o.addListener("click",(()=>{d(new google.maps.LatLng({lat:n,lng:t})),l(new google.maps.LatLng({lat:n,lng:t}))})),a.push(o)})),new MarkerClusterer(e,a,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"}),window.addEventListener("load",(()=>{undefined.done()})),d(e.getCenter()),e.setZoom(13),e.setMapTypeId(t)})),document.getElementById("near-me").addEventListener("click",(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition((({coords:{latitude:n,longitude:o}})=>{d(new google.maps.LatLng({lat:n,lng:o})),e.setZoom(10),e.setMapTypeId(t)}))})),document.getElementById("refresh").addEventListener("click",(()=>{d(e.getCenter())}))};
</script>
      <style type="text/css">/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */html,body{height:100%;margin:0;padding:0}#container{height:100%;display:flex}#sidebar{flex-basis:5rem;flex-grow:1;padding:1rem;max-width:30rem;height:100%;box-sizing:border-box;overflow:auto}#map{flex-basis:0;flex-grow:4;height:100%}:root{--mdc-theme-primary: #1a73e8;--mdc-theme-secondary: #rgb(225, 245, 254);--mdc-theme-on-primary: #fff;--mdc-theme-on-secondary: rgb(1, 87, 155)}.mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-theme-primary)}#sidebar{flex-basis:5rem;flex-direction:column}#search,.mdc-card{margin-bottom:1rem}#search{display:flex;align-items:center}#search .mdc-icon-button,#search .mdc-text-field{margin:0 .1rem 0 0}#search .mdc-icon-button{color:var(--mdc-theme-primary)}#search .mdc-text-field{flex-grow:1}#cards{height:calc(100% - 56px);overflow:scroll}#card-body,#card-header{padding:0 1rem}.progress-wrapper{width:100%;height:100%;display:flex;align-items:center;justify-content:center}
</style>
    </head>

    
    
  </head>
  <body>
    <div id="container">
      <div id="map"></div>
      <div id="sidebar">
        <div id="search">
          <label class="mdc-text-field mdc-text-field--outlined">
            <input
              type="text"
              class="mdc-text-field__input"
              aria-labelledby="my-label-id"
              id="search-input"
            />
            <span class="mdc-notched-outline">
              <span class="mdc-notched-outline__leading"></span>
              <span class="mdc-notched-outline__notch">
                <span class="mdc-floating-label" id="my-label-id"
                  >Enter a location</span
                >
              </span>
              <span class="mdc-notched-outline__trailing"></span>
            </span>
          </label>
          <button id="near-me" class="mdc-icon-button material-icons">
            near_me
          </button>
          <button id="refresh" class="mdc-icon-button material-icons">
            refresh
          </button>
        </div>
        <div id="cards">
          <div class="progress-wrapper"></div>
          
          <script>
            var progressWrapper, progress, progressDiv;
            progressWrapper = document.querySelector(".progress-wrapper");
            // because white space impacts rendering, add via JS to avoid formatting/linting issues
            progressWrapper.innerHTML = `
<div class="mdc-circular-progress mdc-circular-progress--large" role="progressbar" aria-label="Example Progress Bar" aria-valuemin="0" aria-valuemax="1">
  <div class="mdc-circular-progress__determinate-container">
    <svg class="mdc-circular-progress__determinate-circle-graphic" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
      <circle class="mdc-circular-progress__determinate-circle" cx="24" cy="24" r="18" stroke-dasharray="113.097" stroke-dashoffset="113.097"/>
    </svg>
  </div>
  <div class="mdc-circular-progress__indeterminate-container">
    <div class="mdc-circular-progress__spinner-layer">
      <div class="mdc-circular-progress__circle-clipper mdc-circular-progress__circle-left">
        <svg class="mdc-circular-progress__indeterminate-circle-graphic" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <circle cx="24" cy="24" r="18" stroke-dasharray="113.097" stroke-dashoffset="56.549"/>
        </svg>
      </div><div class="mdc-circular-progress__gap-patch">
        <svg class="mdc-circular-progress__indeterminate-circle-graphic" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <circle cx="24" cy="24" r="18" stroke-dasharray="113.097" stroke-dashoffset="56.549"/>
        </svg>
      </div><div class="mdc-circular-progress__circle-clipper mdc-circular-progress__circle-right">
        <svg class="mdc-circular-progress__indeterminate-circle-graphic" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <circle cx="24" cy="24" r="18" stroke-dasharray="113.097" stroke-dashoffset="56.549"/>
        </svg>
      </div>
    </div>
  </div>
</div>
`;
            progress = new mdc.circularProgress.MDCCircularProgress(
              document.querySelector(".mdc-circular-progress")
            );
            progress.open();
            progress.determinate = false;
            progress.done = function () {
              progress.close();
              progressWrapper.remove();
            };
          </script>
        </div>
      </div>
    </div>

    <!-- 
     The `defer` attribute causes the callback to execute after the full HTML
     document has been parsed. For non-blocking uses, avoiding race conditions,
     and consistent behavior across browsers, consider loading using Promises
     with https://www.npmjs.com/package/@googlemaps/js-api-loader.
    -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&callback=initMap&libraries=places,geometry&v=weekly"
      defer
    ></script>
  </body>
</html>

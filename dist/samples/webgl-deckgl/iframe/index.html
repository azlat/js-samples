<!DOCTYPE html>
<!--
 @license
 Copyright 2019 Google LLC. All Rights Reserved.
 SPDX-License-Identifier: Apache-2.0
-->
<html>
  <head>
    <title>WebGL DeckGL OverlayView</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="https://unpkg.com/deck.gl@8.7.3/dist.min.js"></script>

    
    
    <script type="module">var e=Object.defineProperty,t=(t,o,n)=>(((t,o,n)=>{o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n})(t,"symbol"!=typeof o?o+"":o,n),n);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */
let o,n;const r="https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_10m_airports.geojson";window.initMap=function(){const e=51.4709959,s=-.4531566,a=document.getElementById("map");o=new google.maps.Map(a,{zoom:2,center:new google.maps.LatLng(e,s),heading:0,tilt:0,mapId:"b1beacae401d047c"});const i=document.getElementById("tooltip"),l={click:null,dblclick:null,mousemove:null,mouseout:null};class c extends google.maps.WebGLOverlayView{constructor(e,o,n={}){super(),t(this,"canvas"),t(this,"deck"),t(this,"layers_"),t(this,"props"),this.deck=null,this.layers_=o,this.props=n,this.canvas=e}set layers(e){this.layers_=e,this.deck.setProps({layers:[this.layers_]})}onAdd(){}onRemove(){}onContextRestored({gl:t}){const o=this.getMap();this.deck=new deck.Deck({canvas:this.canvas,initialViewState:{longitude:s,latitude:e,pitch:0,zoom:2},gl:t,layers:this.layers_,props:this.props,controller:!1,userData:{map:o}});for(const e in l)l[e]=o.addListener(e,(t=>this.handleMouseEvent(this.deck,e,t)))}onDraw({gl:e,transformer:t}){const o=this.deck;if(!o||!o.layerManager)return;const n=t.getCameraParams(),r=this.canvas.clientWidth,s=this.canvas.clientHeight,a=Math.max(0,n.zoom-1),i=n.tilt,l=n.heading,c=n.center.lat,d=n.center.lng;this.canvas.style.left="0px",this.canvas.style.top="0px",o.setProps({width:r,height:s,viewState:{latitude:c,longitude:d,zoom:a,pitch:i,bearing:l,nearZMultiplier:.01,farZMultiplier:1.01,repeat:!0}}),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.enable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.depthFunc(e.LEQUAL),e.depthMask(!0),this.requestRedraw(),o._drawLayers("google-map-repaint",{clearCanvas:!1})}onContextLost(){}getEventPixel(e,t){const o=t.getViewports()[0].project([e.latLng.lng(),e.latLng.lat()]);return{x:o[0],y:o[1]}}handleMouseEvent(e,t,o){const n={type:t,offsetCenter:this.getEventPixel(o,e),srcEvent:o};switch(t){case"click":e._lastPointerDownInfo=e.pickObject(n.offsetCenter),n.tapCount=1,e._onEvent(n);break;case"dblclick":n.type="click",n.tapCount=2,e._onEvent(n);break;case"mousemove":n.type="pointermove",e._onPointerMove(n);break;case"mouseout":n.type="pointerleave",e._onPointerMove(n);break;default:return}this.requestRedraw()}}const d=[new deck.GeoJsonLayer({id:"airports",data:r,filled:!0,pointRadiusMinPixels:2,opacity:1,pointRadiusScale:2e3,getRadius:e=>11-e.properties.scalerank,getFillColor:[200,0,80,180],pickable:!0,autoHighlight:!0,onHover:function({x:e,y:t,object:o}){o?(i.style.display="block",i.style.left=`${e+5}px`,i.style.top=`${t+5}px`,i.innerHTML=`${o.properties.name} - ${o.properties.abbrev}`):i.style.display="none"}}),new deck.ArcLayer({id:"arcs",data:r,dataTransform:e=>e.features.filter((e=>e.properties.scalerank<4)),getSourcePosition:t=>[s,e],getTargetPosition:e=>e.geometry.coordinates,getSourceColor:[0,128,200],getTargetColor:[200,0,80],getWidth:1})];n=new c(a,d,{}),n.setMap(o)};
</script>
    <style type="text/css">/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */#map{height:100%}html,body{height:100%;margin:0;padding:0}#tooltip{background-color:#fff;border:0;border-radius:2px;box-shadow:0 1px 4px -1px #0000004d;margin:10px;font:400 18px Roboto,Arial,sans-serif;overflow:hidden;position:absolute;height:auto;padding:.5em}
</style>
  </head>
  <body>
    <div id="map"></div>
    <div id="tooltip"></div>

    <!-- 
     The `defer` attribute causes the callback to execute after the full HTML
     document has been parsed. For non-blocking uses, avoiding race conditions,
     and consistent behavior across browsers, consider loading using Promises
     with https://www.npmjs.com/package/@googlemaps/js-api-loader.
    -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&callback=initMap&v=beta"
      defer
    ></script>
  </body>
</html>
